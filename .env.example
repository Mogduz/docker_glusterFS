# ---- Variant B server env ----
# Private bind IP for published ports
PRIVATE_IP=10.0.0.10
# CIDR allowed to access Gluster ports (for firewall)
PRIVATE_CIDR=10.0.0.0/24

# OPTIONAL: public interface name (used to block Gluster ports on public NIC INPUT)
# If empty, script will auto-detect via default route.
PUBLIC_IF=

# OPTIONAL: container name (for docker inspect to find its network/bridge)
CONTAINER_NAME=gluster-solo

# OPTIONAL: port knobs (defaults are Gluster's typical)

# Individual Gluster mgmt ports for compose mapping
MGMT_PORT1=24007
MGMT_PORT2=24008
# Data port range for bricks
DATA_PORT_START=49152
DATA_PORT_END=49251

# ---- Gluster runtime knobs ----
MODE=init                 # init|brick
VTYPE=replica             # replica|disperse (solo nutzt replica)
REPLICA=2
VOLNAME=gv0
BRICK_PATHS=/bricks/brick1,/bricks/brick2
ALLOW_EMPTY_STATE=1
ALLOW_FORCE_CREATE=1
LOG_LEVEL=INFO

# ---- Compose/runtime knobs ----
HOSTNAME_GLUSTER=gluster-solo
RESTART_POLICY=unless-stopped

# Healthcheck timings (Compose strings)
HC_INTERVAL=5s
HC_TIMEOUT=3s
HC_RETRIES=30
HC_START_PERIOD=10s

# ---- Glusterd core knobs ----
ADDRESS_FAMILY=inet         # inet|inet6
MAX_PORT=60999              # upper port bound glusterd may use
TRANSPORT=tcp               # tcp|rdma

# ---- Volume options (comma-separated key=value list) ----
# Example: VOL_OPTS=network.ping-timeout=5,performance.client-io-threads=on,cluster.self-heal-daemon=enable
VOL_OPTS=network.ping-timeout=5,performance.client-io-threads=on

# Disable legacy NFS translator to silence warnings (recommended on modern setups)
NFS_DISABLE=1

# ---- Resource limits (Compose, optional) ----
CPUS=1.0                    # e.g., 0.50, 1.0, 2.0
MEM_LIMIT=1g                # e.g., 512m, 1g

# Optional host bind paths (use with compose.server.variantB.bind.yml)
BRICKS_HOST_ROOT=/srv/gluster/bricks
VARLIB_HOST=/srv/gluster/varlib
LOGS_HOST=/srv/gluster/logs

# Docker image name
IMAGE_NAME=gluster-solo-2bricks

# Docker image tag
IMAGE_TAG=latest

# Base image for Docker build
BASE_IMAGE=debian:12-slim

# APT packages installed in image (space-separated)
GLUSTER_PACKAGES=bash tini glusterfs-server glusterfs-client procps dnsutils iproute2 util-linux

# Extra APT packages (optional)
APT_EXTRAS=

# Container user id (root recommended for gluster)
PUID=0

# Container group id
PGID=0

# Default umask
UMASK=022

# Timezone inside container
TZ=UTC

# Healthcheck command executed with bash -lc
HC_TEST_CMD=gluster volume info >/dev/null 2>&1

# If 0, do not auto-create the volume if missing
CREATE_VOLUME=1

# Value for gluster volume set <VOL> auth.allow; empty to skip
AUTH_ALLOW=${PRIVATE_CIDR}
